<div align="center">
  <img src="assets/logo-light.svg#gh-light-mode-only" alt="marten logo" width="70%">
  <img src="assets/logo-dark.svg#gh-dark-mode-only"  alt="marten logo" width="70%">
</div>

<br>

![License](https://img.shields.io/github/license/parseidon/parseidon)
[![NuGet](https://img.shields.io/nuget/v/Parseidon.Parser.svg)](https://www.nuget.org/packages/Parseidon.Parser)

Parseidon provides an easy tool to generate parsers for custom languages in C#. Additionally, it can create a VS Code extension with the syntax highlighter for the language.

## Features

- Generate pure C# parsers (no runtime dependency).
- Self-hosted parser (the parser itself is generated by itself).
- Emit VS Code language packs or TextMate grammars from the same source.
- The parser can be included just by adding the grammar file to your project (via Roslyn source generator).
- CLI to create the parser or the VS Code package on demand.

## Easy to use

There are two main ways to generate parsers:

1. **Source generator**: add the `Parseidon.SourceGen` package to your project and include `.pgram` files as `AdditionalFiles`; the parser is generated automatically during build.
2. **CLI**: run the `dotnet-parseidon` tool to produce a C# parser file from a `.pgram` grammar.

### Use the source generator:

Add the generator as an analyzer and include your `.pgram` files as `AdditionalFiles`

```xml
<ItemGroup>
  <AdditionalFiles Include="Grammar/**/*.pgram" />
  <PackageReference Include="Parseidon.SourceGen" Version="<version>" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
</ItemGroup>
```

### Use the CLI:

```bash
dotnet parseidon parser GRAMMAR-FILE OUTPUT-FILE
```

\* Requires installing the `dotnet-parseidon` tool first ([see below](#install-the-cli)).<br> \* For more info, see the [CLI reference](docs/cli.md).

## Quickstart

Create a minimal grammar `hello.pgram`:

```parseidon
@namespace: Demo.Parser;
@class: DemoParser;
@root: Expr;

Expr        = Term (('+' | '-') Term)*;
Term        = Factor (('*' | '/') Factor)*;
Factor      = Number | '(' Expr ')';
Number      = [0-9]+;
```

Generate outputs from the same source:

```bash
# C# parser
dotnet parseidon parser hello.pgram out/DemoParser.cs

# VS Code language package
dotnet parseidon vscode hello.pgram out/vscode

# TextMate grammar
dotnet parseidon textmate hello.pgram out/my.tmLanguage.json

# Abstract Syntax Tree as YAML (for inspection/debugging)
dotnet parseidon ast hello.pgram out/hello.ast.yaml
```

\* The VS Code command writes `package.json`, `language-configuration.json`, and `syntaxes/*.tmLanguage.json` into the target folder.

## Install the CLI

Install the CLI:

```bash
dotnet tool install -g dotnet-parseidon
```

Or build from source:

```bash
dotnet pack apps/Cli/Parseidon.Cli.csproj -c Release
dotnet tool install -g dotnet-parseidon --add-source ./Output/bin/Parseidon.Cli/Release
```

## Requirements

- .NET SDK 10.0 or newer (the CLI targets `net10.0`).

## Documentation

- [Grammar guide](docs/grammar.md)
- [Grammar walkthrough](docs/grammar_walkthrough.md)
- [Visitor walkthrough](docs/visitor_walkthrough.md)
- [TextMate / VS Code generation](docs/textmate_vscode.md)
- [CLI reference](docs/cli.md)
- [Source generator usage](docs/sourcegen.md)
